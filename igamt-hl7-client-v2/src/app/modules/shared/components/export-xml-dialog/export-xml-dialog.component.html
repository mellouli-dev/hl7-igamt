<h2 mat-dialog-title>Export XML</h2>
<div class="dialog-container">
  <div *ngIf="step === 1 && !hasFatal && !hasErrors && !verificationFailed && !verificationInProgress" class="alert alert-success">
    Your selected profile(s) have passed the verification.
  </div>
  <div *ngIf="step === 1 && hasFatal" class="alert alert-danger">
    Your selected profile(s) have fatal errors, please fix your profiles and try again.
  </div>
  <div *ngIf="step === 1 && !hasFatal && hasErrors" class="alert alert-danger">
    Your selected profile(s) have errors, please fix your profiles.
  </div>
  <div *ngIf="step === 0 && verificationFailed" class="alert alert-danger">
    {{verificationErrorMessage}}
  </div>
  <div *ngIf="step === 0">
    <label> <strong> Select Conformance Profiles </strong> </label>
    <app-select-resource-ids [resources]="data.conformanceProfiles" (selected)="selectConformanceProfiles($event)"></app-select-resource-ids>
    <br/>
    <label> <strong> Select Composite Profiles </strong> </label>
    <app-select-resource-ids [resources]="data.compositeProfiles" (selected)="selectCompositeProfiles($event)"></app-select-resource-ids>
  </div>
  <div *ngIf="step === 1" style="overflow: hidden;">
    <div *ngIf="verificationInProgress" style="display: flex; align-items: center; justify-content: center; flex-direction:  column;">
        <span>Please wait while we verify your profiles</span>
        <div style="margin-top: 40px;">
          <mat-spinner class="verification-progress" diameter="50"></mat-spinner>
        </div>
    </div>
    <div *ngIf="!verificationInProgress && verificationResult" class="report-container">
      <div style="padding: 10px; border-radius: 4px;border: 1px solid lightgray;background: #f7f7f7;">
        <div><app-issue-badge type="FATAL" label="FATAL"></app-issue-badge> - IGAMT cannot generate the XML; Downstream tools would not be able to process XML.</div>
        <div><app-issue-badge type="ERROR" label="ERROR"></app-issue-badge> - IGAMT can generate the XML; User should fix errors before exporting the XML and using downstream tools.</div>
        <div><app-issue-badge type="WARNING" label="WARNING"></app-issue-badge>  - User should consider providing correct values; Not necessary for downstream tools process.</div>
        <div><app-issue-badge type="INFORMATIONAL" label="INFORMATIONAL"></app-issue-badge> - User should consider changing the value.</div>
      </div>
      <div style="overflow: hidden; width: 80vw;">
        <app-verification-result-display [verificationResult]="verificationResult" [activeSelector]="activeSelector" [showEmpty]="false"></app-verification-result-display>
      </div>
    </div>
  </div>
</div>
<mat-dialog-actions style="justify-content: flex-end;">
  <button *ngIf="!verificationInProgress" (click)="cancel()" class="btn btn-sm btn-danger" style="margin-right: 5px;">Cancel</button>
  <div *ngIf="step === 0">
    <button (click)="verify()" [disabled]="!(ids.conformanceProfilesId?.length > 0 || ids.compositeProfilesId?.length > 0)" class="btn btn-sm btn-success">Select</button>
  </div>
  <div *ngIf="step === 1 && !verificationInProgress">
    <button *ngIf="!hasFatal && !hasErrors" (click)="submit()" class="btn btn-sm btn-success">Submit</button>
    <button *ngIf="!hasFatal && hasErrors" (click)="submit()" class="btn btn-sm btn-warning">Proceed anyway</button>
  </div>
</mat-dialog-actions>

