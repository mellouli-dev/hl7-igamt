<div class="side-bar">
  <ul class="list-group editors">
    <li class="list-group-item cursor-pointer" routerLink="dashboard" routerLinkActive="nav-active-link" >
     <i class="fa fa-home" style ="font-size: larger; margin-right: 5px;"></i> Code Set Management
    </li>
    <li class="list-group-item" style="background-color: #f3f3f3; display: flex;  font-weight: bold;">
      Version History
    </li>
  </ul>
  <div class="filter">
    <div class="input-group" style="margin-left: 5px; min-width: 300px;">
      <div class="input-group-prepend">
        <span class="input-group-text"><i class="fa fa-filter"></i></span>
      </div>
      <input type="text" class="form-control" placeholder="filter" aria-label="filter">
    </div>
  </div>
  <div class="list">
    <div *ngIf="children$ | async as codeSetVersions" style="background-color: #f3f3f3; flex-grow: 1;">
      <ul class="list-group">

        <li style="padding: 0;" [contextMenu]="codeSetVersionMenu" *ngFor="let codeSetVersion of codeSetVersions; let i = index" routerLinkActive="nav-active-link"  [routerLink]="['code-set-version', codeSetVersion.id]" class="list-group-item codeset-version-list-item cursor-pointer" >
          <div style="width: 100px; text-align: center;">
            <span *ngIf="codeSetVersion.dateCommitted" style="color: gray; font-size: 0.75em;">{{codeSetVersion.dateCommitted | date}}</span>
            <span *ngIf="!codeSetVersion.dateCommitted" style="color: gray; font-size: 0.75em;">in progress</span>
          </div>
          <ng-container *ngTemplateOutlet="versionIcon; context: { $implicit: i, single: codeSetVersions.length === 1, size: codeSetVersions.length }"></ng-container>
          <div>
            v<strong>{{codeSetVersion.version}}</strong>


            <span *ngIf="codeSetVersion.dateCommitted" style="margin-left: 10px; font-size: 0.80em; color: black" [ngbPopover]="commitMessage" triggers="mouseenter:mouseleave" container="body" placement="bottom">

              <i class="fa fa-file-text" aria-hidden="true" ></i>

              <ng-template #commitMessage >
                <span>{{codeSetVersion.comments}}</span>
              </ng-template>
            </span>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>

<ng-template #versionIcon let-i let-size="size" let-single="single" >
  <div class="version-icon">
    <div class="version-line" [ngClass]="{
      'version-line-single': single,
      'version-line-top': !single && i === 0,
      'version-line-bottom': !single && i === (size - 1),
      'version-line-middle': !single && i > 0 && i < (size - 1)
    }" ></div>
    <div class="version-ball" [ngClass]="{ 'version-committed': !single && i < (size - 1) , 'version-inprogress': single || i === (size - 1) }"


    ></div>
  </div>
</ng-template>
