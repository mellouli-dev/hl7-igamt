<div class="side-bar">
  <ul class="list-group editors">
    <li class="list-group-item cursor-pointer" routerLink="home" routerLinkActive="nav-active-link" >
      Metadata
    </li>
    <li class="list-group-item" style="background-color: #f3f3f3; display: flex; justify-content: center; align-items: center; font-weight: bold;">
      Versions
      <!-- <button class="btn btn-sm btn-primary" (click)="createFolder()" *ngIf="isAdmin$ | async">
        <i class="fa fa-plus"></i>
      </button> -->
    </li>
  </ul>
  <div class="filter">
    <div class="input-group" style="margin-left: 5px; min-width: 300px;">
      <div class="input-group-prepend">
        <span class="input-group-text"><i class="fa fa-filter"></i></span>
      </div>
      <input type="text" class="form-control" placeholder="filter" aria-label="filter">
    </div>
  </div>
  <div class="list">
    <div *ngIf="children$ | async as codeSetVersions" style="background-color: #f3f3f3; flex-grow: 1;">
      <ul class="list-group">
        <li style="padding: 0;" [contextMenu]="codeSetVersionMenu" *ngFor="let codeSetVersion of codeSetVersions; let i = index" [routerLink]="['code-set-version', codeSetVersion.id]" class="list-group-item codeset-version-list-item cursor-pointer" routerLinkActive="nav-active-link" >
          <ng-container *ngTemplateOutlet="versionIcon; context: { $implicit: i, single: codeSetVersions.length === 1, size: codeSetVersions.length }"></ng-container>
          <div>
            version {{codeSetVersion.version}}
          </div>
        </li>
        <!-- DEMO -->
        <li style="padding: 0;" [contextMenu]="codeSetVersionMenu" *ngFor="let codeSetVersion of [1, 2, 3, 4]; let i = index" class="list-group-item codeset-version-list-item cursor-pointer" >
          <div style="width: 100px; text-align: center;">
            <span *ngIf="i !== 3" style="color: gray; font-size: 0.75em;">10/10/2020</span>
            <span *ngIf="i === 3" style="color: gray; font-size: 0.75em;">in progress</span>
          </div>
          <ng-container *ngTemplateOutlet="versionIcon; context: { $implicit: i, single: false, size: 4 }"></ng-container>
          <div>
            v<strong>{{codeSetVersion}}</strong>
            <span *ngIf="i === 2" style="margin-left: 10px; font-size: 0.80em; color: blue;"><i class="fa fa-external-link" aria-hidden="true"></i>
            </span>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>

<ng-template #versionIcon let-i let-size="size" let-single="single" >
  <div class="version-icon">
    <div class="version-line" [ngClass]="{ 
      'version-line-single': single, 
      'version-line-top': !single && i === 0, 
      'version-line-bottom': !single && i === (size - 1),
      'version-line-middle': !single && i > 0 && i < (size - 1)
    }" ></div>
    <div class="version-ball" [ngClass]="{ 'version-committed': !single && i < (size - 1) , 'version-inprogress': single || i === (size - 1) }" ></div>
  </div>
</ng-template>